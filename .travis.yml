language: go
go_import_path: code.impractical.co/tokens

go:
  - 1.7.1
before_script: 
  - psql -c 'create database travis_ci_test;' -U postgres
  - go get -u github.com/paddyforan/combinedcoverage
  - go get -u github.com/wadey/gocovmerge
  - go get -u github.com/golang/lint/golint
env:
  - PG_TEST_DB="postgres://postgres:@localhost/travis_ci_test?sslmode=disable"
script:
  - go vet $(go list ./... | grep -v /vendor/)
  - find . -name '*.go' | xargs grep -L '// Code generated by ' | grep -v /vendor/ | xargs -L1 golint
  - ./coverage.sh

services:
  - postgresql

addons:
  postgresql: "9.3"
